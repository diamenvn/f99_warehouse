{"ast":null,"code":"import _toConsumableArray from\"/Users/dante/Documents/SOURCE CODE/myteam/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _defineProperty from\"/Users/dante/Documents/SOURCE CODE/myteam/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"/Users/dante/Documents/SOURCE CODE/myteam/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/dante/Documents/SOURCE CODE/myteam/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _createSuper from\"/Users/dante/Documents/SOURCE CODE/myteam/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _inherits from\"/Users/dante/Documents/SOURCE CODE/myteam/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import{FcAddDatabase,FcEmptyTrash}from'react-icons/fc';import{AiFillDelete}from'react-icons/ai';import{Tabs,Table,Button,Drawer,Row,Col,Form,Input,message,Spin,Tag,Popconfirm}from'antd';import{AppAPI}from'../../../../api/appApi';var TabPane=Tabs.TabPane;var columns=[{title:'STT',dataIndex:'stt',key:'stt',width:50},{title:'API Gửi data',dataIndex:'api_value',key:'api_value',width:500},{title:'Ngày tạo API',dataIndex:'created_at',key:'created_at',width:150},{title:'Trạng thái',dataIndex:'status',key:'status',width:150},{title:'Thao tác',dataIndex:'action',key:'action',width:150}];var Main=/*#__PURE__*/function(_Component){_inherits(Main,_Component);var _super=_createSuper(Main);function Main(){var _this;_classCallCheck(this,Main);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state=_defineProperty({loading:false,listDeviceState:[],emptyData:true,nameDeviceState:\"\"},\"loading\",false);_this.fetchDataFromAPI=function(){AppAPI.getAllDevice().then(function(res){var data=res.data;var key=0;if(data.success){data.data.map(function(res){key+=1;var apiKey=0;var dataSource=[];res.api.map(function(resAPI){apiKey+=1;var object={stt:apiKey,api_value:AppAPI.BASE_URL+\"/api/v1/device/pushDataFromFingerprint/\"+resAPI.access_token,created_at:resAPI.created_at,status:resAPI.status==1?/*#__PURE__*/React.createElement(Tag,{color:\"#87d068\"},\"\\u0110ang ho\\u1EA1t \\u0111\\u1ED9ng\"):/*#__PURE__*/React.createElement(Tag,{color:\"#f50\"},\"\\u0110\\xE3 t\\u1EA1m d\\u1EEBng\"),action:/*#__PURE__*/React.createElement(AiFillDelete,{onClick:function onClick(e){return _this.removeItemApi(resAPI);},className:\"icon--hover-red\"})};dataSource.push(object);});var obj=/*#__PURE__*/React.createElement(TabPane,{tab:res.device_name,key:key},/*#__PURE__*/React.createElement(Table,{locale:\"B\\u1EA1n ch\\u01B0a t\\u1EA1o API n\\xE0o \\u0111\\u1EC3 k\\u1EBFt n\\u1ED1i\",pagination:false,dataSource:dataSource,columns:columns}),/*#__PURE__*/React.createElement(\"div\",{className:\"bottom p-5\"},/*#__PURE__*/React.createElement(Popconfirm,{onConfirm:function onConfirm(e){return _this.removeDevice(res);},title:\"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n xo\\xE1\\uFF1F\",okText:\"\\u0110\\u1ED3ng \\xFD\",cancelText:\"Hu\\u1EF7 b\\u1ECF\"},/*#__PURE__*/React.createElement(Button,{className:\"px-5\",type:\"primary\",danger:true},/*#__PURE__*/React.createElement(FcAddDatabase,null),\"Xo\\xE1 m\\xE1y ch\\u1EA5m c\\xF4ng\")),/*#__PURE__*/React.createElement(Button,{className:\"ml-10\",onClick:function onClick(e){return _this.addApi(res);},type:\"primary\"},/*#__PURE__*/React.createElement(FcAddDatabase,null),\"Th\\xEAm m\\u1EDBi API\")));_this.setState(function(prevState){return{listDeviceState:[].concat(_toConsumableArray(prevState.listDeviceState),[obj])};});});if(data.data.length>0){_this.setState({emptyData:false});}}});};_this.addDevice=function(e){var nameDeviceState=_this.state.nameDeviceState;if(!!!nameDeviceState){message.error(\"Vui lòng nhập tên thiết bị!\");return;}var data={name:nameDeviceState};AppAPI.addDevice(data).then(function(res){var data=res.data;if(data.success){message.success(data.msg);window.location.reload();}else{message.error(data.msg);}}).catch(function(res){message.error(res.message);});};_this.addApi=function(e){var data={_id:e._id};AppAPI.addApiReciverData(data).then(function(res){var data=res.data;if(data.success){message.success(data.msg);window.location.reload();}else{message.error(data.msg);}}).catch(function(res){message.error(res.message);});};_this.removeDevice=function(e){var data={_id:e._id};AppAPI.removeDevice(data).then(function(res){var data=res.data;if(data.success){message.success(data.msg);window.location.reload();}else{message.error(data.msg);}}).catch(function(res){message.error(res.message);});};_this.removeItemApi=function(e){var data={_id:e._id,device_id:e.device_id};AppAPI.removeItemAPI(data).then(function(res){var data=res.data;if(data.success){message.success(data.msg);window.location.reload();}else{message.error(data.msg);}}).catch(function(res){message.error(res.message);});};_this.changeNameDevice=function(e){_this.setState({nameDeviceState:e.target.value});};_this.onClose=function(){_this.props.toogleClickAdd();};return _this;}_createClass(Main,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchDataFromAPI();}},{key:\"render\",value:function render(){var _this2=this;var empty=/*#__PURE__*/React.createElement(\"h3\",null,/*#__PURE__*/React.createElement(FcEmptyTrash,null),\"Kh\\xF4ng c\\xF3 m\\xE1y ch\\u1EA5m c\\xF4ng n\\xE0o, b\\u1EA1n h\\xE3y th\\xEAm m\\xE1y m\\u1EDBi \\u0111\\u1EC3 b\\u1EAFt \\u0111\\u1EA7u s\\u1EED d\\u1EE5ng\");var _this$state2=this.state,listDeviceState=_this$state2.listDeviceState,emptyData=_this$state2.emptyData,nameDeviceState=_this$state2.nameDeviceState,loading=_this$state2.loading;var clickAdd=this.props.clickAdd;return/*#__PURE__*/React.createElement(\"section\",{className:\"main-dashboard main-dashboard--layout flex-1\"},!emptyData?/*#__PURE__*/React.createElement(\"div\",{className:\"card-container\"},/*#__PURE__*/React.createElement(Spin,{spinning:loading,tip:\"Loading...\"},/*#__PURE__*/React.createElement(Tabs,{type:\"card\"},listDeviceState))):/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex p-10\"},empty),/*#__PURE__*/React.createElement(Drawer,{title:\"Th\\xEAm m\\xE1y ch\\u1EA5m c\\xF4ng\",width:300,visible:clickAdd,onClose:this.onClose,bodyStyle:{paddingBottom:80},footer:/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'right'}},/*#__PURE__*/React.createElement(Button,{type:\"primary\",onClick:function onClick(e){return _this2.addDevice(e);}},\"Th\\xEAm m\\u1EDBi\"))},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{span:24},/*#__PURE__*/React.createElement(Form.Item,{name:\"name\",label:\"T\\xEAn m\\xE1y ch\\u1EA5m c\\xF4ng\",rules:[{required:true,message:'Please enter user name'}]},/*#__PURE__*/React.createElement(Input,{value:nameDeviceState,onChange:function onChange(e){return _this2.changeNameDevice(e);},placeholder:\"Nh\\u1EADp t\\xEAn m\\xE1y ch\\u1EA5m c\\xF4ng v\\xE0o \\u0111\\xE2y\"}))))));}}]);return Main;}(Component);export default Main;","map":{"version":3,"sources":["/Users/dante/Documents/SOURCE CODE/myteam/src/components/site/setting/fingerprint/main.js"],"names":["React","Component","FcAddDatabase","FcEmptyTrash","AiFillDelete","Tabs","Table","Button","Drawer","Row","Col","Form","Input","message","Spin","Tag","Popconfirm","AppAPI","TabPane","columns","title","dataIndex","key","width","Main","state","loading","listDeviceState","emptyData","nameDeviceState","fetchDataFromAPI","getAllDevice","then","res","data","success","map","apiKey","dataSource","api","resAPI","object","stt","api_value","BASE_URL","access_token","created_at","status","action","e","removeItemApi","push","obj","device_name","removeDevice","addApi","setState","prevState","length","addDevice","error","name","msg","window","location","reload","catch","_id","addApiReciverData","device_id","removeItemAPI","changeNameDevice","target","value","onClose","props","toogleClickAdd","empty","clickAdd","paddingBottom","textAlign","required"],"mappings":"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","sourcesContent":["import React, {\n    Component\n} from 'react';\nimport { FcAddDatabase, FcEmptyTrash } from 'react-icons/fc';\nimport { AiFillDelete } from 'react-icons/ai';\nimport { Tabs, Table, Button, Drawer, Row, Col, Form, Input, message, Spin, Tag, Popconfirm } from 'antd';\nimport { AppAPI } from '../../../../api/appApi';\n\nconst { TabPane } = Tabs;\n\nconst columns = [\n    {\n        title: 'STT',\n        dataIndex: 'stt',\n        key: 'stt',\n        width: 50\n    },\n    {\n        title: 'API Gửi data',\n        dataIndex: 'api_value',\n        key: 'api_value',\n        width: 500\n    },\n    {\n        title: 'Ngày tạo API',\n        dataIndex: 'created_at',\n        key: 'created_at',\n        width: 150\n    },\n    {\n        title: 'Trạng thái',\n        dataIndex: 'status',\n        key: 'status',\n        width: 150\n    },\n    {\n        title: 'Thao tác',\n        dataIndex: 'action',\n        key: 'action',\n        width: 150\n    },\n];\n\nclass Main extends Component {\n    state = {\n        loading: false,\n        listDeviceState: [],\n        emptyData: true,\n        nameDeviceState: \"\",\n        loading: false\n    }\n\n    componentDidMount() {\n        this.fetchDataFromAPI();\n    }\n\n    render() {\n        const empty = (\n            <h3><FcEmptyTrash />Không có máy chấm công nào, bạn hãy thêm máy mới để bắt đầu sử dụng</h3>\n        );\n        const { listDeviceState, emptyData, nameDeviceState, loading } = this.state;\n        const { clickAdd } = this.props;\n        return (\n            <section className=\"main-dashboard main-dashboard--layout flex-1\">\n                {!emptyData ?\n                    <div className=\"card-container\">\n                        <Spin spinning={loading} tip=\"Loading...\">\n                            <Tabs type=\"card\">\n                                {listDeviceState}\n                            </Tabs>\n                        </Spin>\n                    </div> :\n                    <div className=\"d-flex p-10\">\n                        {empty}\n                    </div>\n                }\n                <Drawer\n                    title=\"Thêm máy chấm công\"\n                    width={300}\n                    visible={clickAdd}\n                    onClose={this.onClose}\n                    bodyStyle={{ paddingBottom: 80 }}\n                    footer={\n                        <div\n                            style={{\n                                textAlign: 'right',\n                            }}\n                        >\n                            <Button type=\"primary\" onClick={(e) => this.addDevice(e)}>\n                                Thêm mới\n                            </Button>\n                        </div>\n                    }>\n                    <Row>\n                        <Col span={24}>\n                            <Form.Item\n                                name=\"name\"\n                                label=\"Tên máy chấm công\"\n                                rules={[{ required: true, message: 'Please enter user name' }]}\n                            >\n                                <Input value={nameDeviceState} onChange={(e) => this.changeNameDevice(e)} placeholder=\"Nhập tên máy chấm công vào đây\" />\n                            </Form.Item>\n                        </Col>\n                    </Row>\n                </Drawer>\n            </section>\n\n        );\n\n    }\n\n    fetchDataFromAPI = () => {\n        AppAPI.getAllDevice().then(res => {\n            const { data } = res;\n            var key = 0;\n            if (data.success) {\n                data.data.map(res => {\n                    key += 1;\n                    let apiKey = 0;\n                    let dataSource = [];\n                    res.api.map(resAPI => {\n                        apiKey += 1;\n                        let object = {\n                            stt: apiKey,\n                            api_value: AppAPI.BASE_URL + \"/api/v1/device/pushDataFromFingerprint/\" + resAPI.access_token,\n                            created_at: resAPI.created_at,\n                            status: resAPI.status == 1 ? <Tag color=\"#87d068\">Đang hoạt động</Tag> : <Tag color=\"#f50\">Đã tạm dừng</Tag>,\n                            action: <AiFillDelete onClick={(e) => this.removeItemApi(resAPI)} className=\"icon--hover-red\" />\n                        }\n                        dataSource.push(object);\n                    });\n\n                    const obj = (\n                        <TabPane tab={res.device_name} key={key} >\n                            <Table locale=\"Bạn chưa tạo API nào để kết nối\" pagination={false} dataSource={dataSource} columns={columns} />\n                            <div className=\"bottom p-5\">\n                                <Popconfirm onConfirm={(e) => this.removeDevice(res)} title=\"Bạn có chắc chắn muốn xoá？\" okText=\"Đồng ý\" cancelText=\"Huỷ bỏ\">\n                                    <Button className=\"px-5\" type=\"primary\" danger><FcAddDatabase />Xoá máy chấm công</Button>\n                                </Popconfirm>\n                                <Button className=\"ml-10\" onClick={(e) => this.addApi(res)} type=\"primary\"><FcAddDatabase />Thêm mới API</Button>\n                            </div>\n                        </TabPane>\n                    );\n                    this.setState(prevState => ({\n                        listDeviceState: [...prevState.listDeviceState, obj]\n                    }));\n                });\n                if (data.data.length > 0) {\n                    this.setState({ emptyData: false });\n                }\n            }\n        });\n    }\n\n    addDevice = e => {\n        const { nameDeviceState } = this.state;\n        if (!!!nameDeviceState) {\n            message.error(\"Vui lòng nhập tên thiết bị!\");\n            return;\n        }\n\n        let data = {\n            name: nameDeviceState\n        };\n        AppAPI.addDevice(data).then(res => {\n            const { data } = res;\n            if (data.success) {\n                message.success(data.msg);\n                window.location.reload();\n            } else {\n                message.error(data.msg);\n            }\n        }).catch(res => {\n            message.error(res.message);\n        });\n    }\n\n    addApi = e => {\n        let data = {\n            _id: e._id\n        };\n        AppAPI.addApiReciverData(data).then(res => {\n            const { data } = res;\n            if (data.success) {\n                message.success(data.msg);\n                window.location.reload();\n            } else {\n                message.error(data.msg);\n            }\n        }).catch(res => {\n            message.error(res.message);\n        });\n    }\n\n    removeDevice = (e) => {\n        let data = {\n            _id: e._id\n        };\n        AppAPI.removeDevice(data).then(res => {\n            const { data } = res;\n            if (data.success) {\n                message.success(data.msg);\n                window.location.reload();\n            } else {\n                message.error(data.msg);\n            }\n        }).catch(res => {\n            message.error(res.message);\n        });\n    }\n\n    removeItemApi = (e) => {\n        let data = {\n            _id: e._id,\n            device_id: e.device_id\n        };\n        AppAPI.removeItemAPI(data).then(res => {\n            const { data } = res;\n            if (data.success) {\n                message.success(data.msg);\n                window.location.reload();\n            } else {\n                message.error(data.msg);\n            }\n        }).catch(res => {\n            message.error(res.message);\n        });\n    }\n\n    changeNameDevice = e => {\n        this.setState({\n            nameDeviceState: e.target.value\n        });\n    }\n\n    onClose = () => {\n        this.props.toogleClickAdd();\n    };\n}\n\n\nexport default Main;"]},"metadata":{},"sourceType":"module"}